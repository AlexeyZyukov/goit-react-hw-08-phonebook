(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{14:function(t,e,n){"use strict";var c=n(11),r=n.n(c),a=n(18),u=n(13),o=n.n(u),s=n(3);o.a.defaults.baseURL="https://connections-api.herokuapp.com";var i=function(t){o.a.defaults.headers.common.Authorization="Bearer ".concat(t)},l=function(){o.a.defaults.headers.common.Authorization=""},j=Object(s.c)("auth/register",function(){var t=Object(a.a)(r.a.mark((function t(e,n){var c,a,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=n.rejectWithValue,t.prev=1,t.next=4,o.a.post("user/signup",e);case 4:return a=t.sent,u=a.data,i(u.token),t.abrupt("return",u);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",c(t.t0.data));case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}()),d=Object(s.c)("auth/login",function(){var t=Object(a.a)(r.a.mark((function t(e,n){var c,a,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=n.rejectWithValue,t.prev=1,t.next=4,o.a.post("user/login",e);case 4:return a=t.sent,u=a.data,i(u.token),t.abrupt("return",u);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",c(t.t0.data));case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}()),b=Object(s.c)("auth/logout",function(){var t=Object(a.a)(r.a.mark((function t(e,n){var c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=n.rejectWithValue,t.prev=1,t.next=4,o.a.post("user/logout");case 4:l(),t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",c(t.t0.data));case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e,n){return t.apply(this,arguments)}}()),f=Object(s.c)("auth/refresh",function(){var t=Object(a.a)(r.a.mark((function t(e,n){var c,a,u,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=n.getState(),null!==(a=c.auth.token)){t.next=5;break}return console.log("\u0422\u043e\u043a\u0435\u043d\u0430 \u043d\u0435\u0442"),t.abrupt("return",n.rejectWithValue());case 5:return i(a),t.prev=6,t.next=9,o.a.get("/users/current");case 9:return u=t.sent,s=u.data,t.abrupt("return",s);case 14:return t.prev=14,t.t0=t.catch(6),t.abrupt("return",n.rejectWithValue());case 17:case"end":return t.stop()}}),t,null,[[6,14]])})));return function(e,n){return t.apply(this,arguments)}}()),O={register:j,logIn:d,logOut:b,fetchCurrentUser:f};e.a=O},22:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var c=n(40),r=n.n(c),a=n(1);function u(t){var e=t.children;return Object(a.jsx)("div",{className:r.a.container,children:e})}},24:function(t,e,n){t.exports={nav:"Navigation_nav__3CzRu",link:"Navigation_link__3DyUu"}},25:function(t,e,n){t.exports={userMenuTitle:"userMenu_userMenuTitle__6qshL",userMenu:"userMenu_userMenu__230HB",button:"userMenu_button__2e4oY"}},28:function(t,e,n){t.exports={link:"AuthMenu_link__2HiCh",activeLink:"AuthMenu_activeLink__3P4Du"}},40:function(t,e,n){t.exports={container:"Container_container__3PBT8"}},41:function(t,e,n){t.exports={barHeader:"AppBar_barHeader__1O8YY"}},44:function(t,e,n){t.exports={loaderWrapper:"Loader_loaderWrapper__2r-H9"}},77:function(t,e,n){},78:function(t,e,n){"use strict";n.r(e);var c,r,a,u=n(0),o=n.n(u),s=n(21),i=n.n(s),l=n(10),j=n(6),d=n(38),b=n(23),f=n(3),O=n(12),h=n(39),p=n.n(h),x=n(4),g=n(5),v=n(8),m=Object(f.d)([],(c={},Object(x.a)(c,v.fetchContactSuccess,(function(t,e){return e.payload})),Object(x.a)(c,v.addContactSuccess,(function(t,e){var n=e.payload;return t.map((function(t){return t.name})).includes(n.name)?(alert("".concat(n.name," is already in contacts!")),t):[].concat(Object(b.a)(t),[n])})),Object(x.a)(c,v.delContactSuccess,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),c)),C=Object(f.d)("",Object(x.a)({},v.filterContacts,(function(t,e){return e.payload}))),k=Object(f.d)(!1,(r={},Object(x.a)(r,v.fetchContactRequest,(function(){return!0})),Object(x.a)(r,v.fetchContactSuccess,(function(){return!1})),Object(x.a)(r,v.fetchContactError,(function(){return!1})),Object(x.a)(r,v.addContactRequest,(function(){return!0})),Object(x.a)(r,v.addContactSuccess,(function(){return!1})),Object(x.a)(r,v.addContactError,(function(){return!1})),Object(x.a)(r,v.delContactRequest,(function(){return!0})),Object(x.a)(r,v.delContactSuccess,(function(){return!1})),Object(x.a)(r,v.delContactError,(function(){return!1})),r)),_=Object(g.b)({items:m,filter:C,loading:k}),y=n(14),L={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUserName:function(t){return t.auth.user.name}},I=Object(f.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1},extraReducers:(a={},Object(x.a)(a,y.a.register.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(x.a)(a,y.a.logIn.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(x.a)(a,y.a.logOut.fulfilled,(function(t,e){t.user={name:"",email:""},t.token=null,t.isLoggedIn=!1})),Object(x.a)(a,y.a.fetchCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.isLoggedIn=!0})),a)}).reducer,S=Object(b.a)(Object(f.f)({serializableCheck:{ignoredActions:[O.a,O.f,O.b,O.c,O.d,O.e]}})),w={key:"auth",storage:p.a,whitelist:["token"]},N=Object(f.a)({reducer:{auth:Object(O.g)(w,I),contacts:_},middleware:S,devTools:!1}),E=Object(O.h)(N),R=n(2),M=n(1);function T(t){var e=t.restricted,n=void 0!==e&&e,c=t.redirectTo,r=void 0===c?"/":c;return Object(j.d)(L.getIsLoggedIn)&&n?Object(M.jsx)(R.a,{to:r}):Object(M.jsx)(R.b,{})}function q(t){var e=t.redirectTo,n=void 0===e?"/":e;return Object(j.d)(L.getIsLoggedIn)?Object(M.jsx)(R.b,{}):Object(M.jsx)(R.a,{to:n})}var W=n(24),z=n.n(W),H=function(){var t=Object(j.d)(L.getIsLoggedIn);return Object(M.jsxs)("nav",{className:z.a.nav,children:[Object(M.jsx)(l.b,{to:"/",exact:"true",className:z.a.link,children:"Home"}),t&&Object(M.jsx)(l.b,{to:"/contacts",exact:"true",className:z.a.link,children:"Contacts"})]})},U=n(22),A=n(28),B=n.n(A);function V(){return Object(M.jsxs)("div",{children:[Object(M.jsx)(l.b,{exact:"true",to:"/register",className:B.a.link,children:"Register"}),Object(M.jsx)(l.b,{exact:"true",to:"/login",className:B.a.link,children:"Login"})]})}var F=n(25),D=n.n(F);function Y(){var t=Object(j.c)(),e=Object(j.d)(L.getUserName);return Object(M.jsxs)("div",{className:D.a.userMenu,children:[Object(M.jsxs)("span",{className:D.a.userMenuTitle,children:["Welcome, ",e]}),Object(M.jsx)("button",{className:D.a.button,type:"button",onClick:function(){return t(y.a.logOut())},children:"Log out"})]})}var J=n(41),P=n.n(J);function G(){var t=Object(j.d)(L.getIsLoggedIn);return Object(M.jsx)(U.a,{children:Object(M.jsxs)("div",{className:P.a.barHeader,children:[Object(M.jsx)(H,{}),t?Object(M.jsx)(Y,{}):Object(M.jsx)(V,{})]})})}var K=n(42),Q=n(43),X=n(47),Z=n(46),$=n(45),tt=n(44),et=n.n(tt),nt=function(t){Object(X.a)(n,t);var e=Object(Z.a)(n);function n(){return Object(K.a)(this,n),e.apply(this,arguments)}return Object(Q.a)(n,[{key:"render",value:function(){return Object(M.jsx)("div",{className:et.a.loaderWrapper,children:Object(M.jsx)($.a,{color:"#00BFFF",height:100,width:100,timeout:3e3,visible:!0,ariaLabel:"loading"})})}}]),n}(u.Component),ct=Object(u.lazy)((function(){return n.e(4).then(n.bind(null,85))})),rt=Object(u.lazy)((function(){return n.e(6).then(n.bind(null,86))})),at=Object(u.lazy)((function(){return n.e(5).then(n.bind(null,87))})),ut=Object(u.lazy)((function(){return n.e(3).then(n.bind(null,88))}));function ot(){var t=Object(j.c)();return Object(u.useEffect)((function(){return t(y.a.fetchCurrentUser())}),[t]),Object(M.jsxs)(U.a,{children:[Object(M.jsx)(G,{}),Object(M.jsx)(u.Suspense,{fallback:Object(M.jsx)(nt,{}),children:Object(M.jsxs)(R.e,{children:[Object(M.jsx)(R.c,{path:"/",element:Object(M.jsx)(T,{}),children:Object(M.jsx)(R.c,{path:"/",element:Object(M.jsx)(ct,{})})}),Object(M.jsx)(R.c,{path:"/register",element:Object(M.jsx)(T,{restricted:!0,redirectTo:"/contacts"}),children:Object(M.jsx)(R.c,{path:"/register",element:Object(M.jsx)(rt,{})})}),Object(M.jsx)(R.c,{path:"/login",element:Object(M.jsx)(T,{restricted:!0,redirectTo:"/contacts"}),children:Object(M.jsx)(R.c,{path:"/login",element:Object(M.jsx)(at,{})})}),Object(M.jsx)(R.c,{element:Object(M.jsx)(q,{path:"/contacts",redirectTo:"/"}),children:Object(M.jsx)(R.c,{path:"/contacts",element:Object(M.jsx)(ut,{})})})]})})]})}n(77);i.a.render(Object(M.jsx)(o.a.StrictMode,{children:Object(M.jsx)(j.a,{store:N,children:Object(M.jsx)(d.a,{loading:null,persistor:E,children:Object(M.jsx)(l.a,{children:Object(M.jsx)(ot,{})})})})}),document.querySelector("#root"))},8:function(t,e,n){"use strict";n.r(e),n.d(e,"fetchContactRequest",(function(){return r})),n.d(e,"fetchContactSuccess",(function(){return a})),n.d(e,"fetchContactError",(function(){return u})),n.d(e,"addContactRequest",(function(){return o})),n.d(e,"addContactSuccess",(function(){return s})),n.d(e,"addContactError",(function(){return i})),n.d(e,"delContactRequest",(function(){return l})),n.d(e,"delContactSuccess",(function(){return j})),n.d(e,"delContactError",(function(){return d})),n.d(e,"delContacts",(function(){return b})),n.d(e,"filterContacts",(function(){return f}));var c=n(3),r=Object(c.b)("contacts/fetchContactRequest"),a=Object(c.b)("contacts/fetchContactSuccess"),u=Object(c.b)("contacts/fetchContactError"),o=Object(c.b)("contacts/addContactRequest"),s=Object(c.b)("contacts/addContactSuccess"),i=Object(c.b)("contacts/addContactError"),l=Object(c.b)("contacts/delContactRequest"),j=Object(c.b)("contacts/delContactSuccess"),d=Object(c.b)("contacts/delContactError"),b=Object(c.b)("contacts/DELETE"),f=Object(c.b)("contacts/FILTER")}},[[78,1,2]]]);
//# sourceMappingURL=main.6fc1f72d.chunk.js.map